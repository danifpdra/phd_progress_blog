<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <title>Daniela's PhD</title>
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico"/>
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"
          type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
          rel="stylesheet" type="text/css"/>
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="../css/styles.css" rel="stylesheet"/>

    <style>
        * {
            box-sizing: border-box;
        }

        .img-zoom-container {
            position: relative;
        }

        .img-zoom-lens {
            position: absolute;
            border: 1px solid #d4d4d4;
            /*set the size of the lens:*/
            width: 80px;
            height: 80px;
        }

        .img-zoom-result {
            border: 1px solid #d4d4d4;
            /*set the size of the result div:*/
            width: 500px;
            height: 500px;
            margin-left: auto;
            margin-right: auto;
        }


    </style>
    <script>
        function imageZoom(imgID, resultID) {
            var img, lens, result, cx, cy;
            img = document.getElementById(imgID);
            result = document.getElementById(resultID);
            /*create lens:*/
            lens = document.createElement("DIV");
            lens.setAttribute("class", "img-zoom-lens");
            /*insert lens:*/
            img.parentElement.insertBefore(lens, img);
            /*calculate the ratio between result DIV and lens:*/
            cx = result.offsetWidth / lens.offsetWidth;
            cy = result.offsetHeight / lens.offsetHeight;
            /*set background properties for the result DIV:*/
            result.style.backgroundImage = "url('" + img.src + "')";
            result.style.backgroundSize = (img.width * cx) + "px " + (img.height * cy) + "px";
            /*execute a function when someone moves the cursor over the image, or the lens:*/
            lens.addEventListener("mousemove", moveLens);
            img.addEventListener("mousemove", moveLens);
            /*and also for touch screens:*/
            lens.addEventListener("touchmove", moveLens);
            img.addEventListener("touchmove", moveLens);

            function moveLens(e) {
                var pos, x, y;
                /*prevent any other actions that may occur when moving over the image:*/
                e.preventDefault();
                /*get the cursor's x and y positions:*/
                pos = getCursorPos(e);
                /*calculate the position of the lens:*/
                x = pos.x - (lens.offsetWidth / 2);
                y = pos.y - (lens.offsetHeight / 2);
                /*prevent the lens from being positioned outside the image:*/
                if (x > img.width - lens.offsetWidth) {
                    x = img.width - lens.offsetWidth;
                }
                if (x < 0) {
                    x = 0;
                }
                if (y > img.height - lens.offsetHeight) {
                    y = img.height - lens.offsetHeight;
                }
                if (y < 0) {
                    y = 0;
                }
                /*set the position of the lens:*/
                lens.style.left = x + "px";
                lens.style.top = y + "px";
                /*display what the lens "sees":*/
                result.style.backgroundPosition = "-" + (x * cx) + "px -" + (y * cy) + "px";
            }

            function getCursorPos(e) {
                var a, x = 0, y = 0;
                e = e || window.event;
                /*get the x and y positions of the image:*/
                a = img.getBoundingClientRect();
                /*calculate the cursor's x and y coordinates, relative to the image:*/
                x = e.pageX - a.left;
                y = e.pageY - a.top;
                /*consider any page scrolling:*/
                x = x - window.pageXOffset;
                y = y - window.pageYOffset;
                return {x: x, y: y};
            }
        }
    </script>
</head>
<body>
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
    <div class="container px-4 px-lg-5">
        <a class="navbar-brand" href="../index.html">Daniela's PhD</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            Menu
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ms-auto py-4 py-lg-0">
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="about.html">About</a></li>
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="post.html">Sample Post</a></li>
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="contact.html">Contact</a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- Page Header-->
<header class="masthead" style="background-image: url('../assets/img/larcc_2.jpeg')">
    <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="post-heading">
                    <h1>Week 11th of Novemeber... </h1>
                    <h2 class="subheading">Year 2</h2>
                    <span class="meta">
                                Posted by
                                <a href="#!">Daniela Rato</a>
                                on November 11, 2021
                            </span>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- Post Content-->
<article class="mb-4">
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <h2 class="section-heading"> Study of Solutions to Identify the Charuco Shape in the Depth Image </h2>


                <p>
                    To segment the shape of the calibration pattern in the depth image, several tests were conducted
                    with
                    edge detection and find contours algorithms to see how well the real depth images could be
                    segmented.
                    The following figure shows the result of these tests applied to the same depth image containing the
                    chessboard.
                </p>
                <p>
                    The depth image is originally a float image, so none of the OpenCV toolbox functions works in these
                    images. Conversion to uint8 is also not an option because the conversion would mean a significant
                    loss of resolution, which caused even more difficulties to detect the difference between the
                    chessboard and its support. For this reason, I opted to use the Skimage toolkit, that allows to
                    apply inumerous filters to float images without a problem.
                </p>


                <a href="#!"><img class="img-fluid" src="../assets/img/filters.jpeg"
                                  alt="..."/></a>

                <p>
                    After seeing the none of these algorithms were producing a good segmentation of the chessboard, we
                    developed our own flood fill algorithm by hand. This algorithm produces best results, but still a
                    part of the support is still seen as a part of the chessboard. The flood fill algorithms work by
                    evaluating the gradients between neighbor pixels, and the chessboard is distanced from the support
                    around 20cm, which didn't make sense of why the flood and fill was considering it part of the
                    chessboard, since its tolerance of distance to neighbor pixels is much smaller. This made us inspect
                    why the depth point cloud to investigate why this was happenings
                </p>
                <a href="#!"><img class="img-fluid" src="../assets/img/flood_fill.png"
                                  alt="..."/></a>

                <p>The following image shows the point cloud in the area where the support is appearing as part of the
                    chessboard. As we can see, there is a slope between the actual chessboard and the support that
                    appears next to it. Apparently this is a common problem in range sensors: when the distance between
                    two objects is short, the adjacent infrared rays that are projected to measure the distances are too
                    close and create a misperception of the 3D shapes. </p>

                <a href="#!"><img class="img-fluid" src="../assets/img/depth_pc_bug.png"
                                  alt="..."/></a>

                <p> To correct this problem I propose two complementary solutions:</p>
                <ul>
                    <li>Paint the chessboard support with matt black paint, which is a color that is very badly
                        perceived by depth sensors, which could help to mask the support in the image
                    </li>
                    <li>
                        Add a new horizontal beam to the support, as seen in the following image, with a counterweight
                        on the other end of this beam, that allows to adapt the already existing support to move the
                        chessboard further away from the support, which hopefully will solve the slope problem in the
                        depth images/point clouds.
                    </li>
                </ul>


                <img class="img-fluid" src="../assets/img/new_support.png"
                                  alt="..."/>

                <p> TODO </p>
                <ul>
                    <li>Check inconsistencies in calibration results with real data</li>
                    <li>Adapt ATOM to calibrate RGBD sensors.</li>
                    <li>Improve calibration pattern support to improve the depth images</li>
                    <li>Define solution to detect calibration pattern in depth image</li>
                </ul>
                <p>

                </p>
                <!--                <div class="my-4">-->

                <h4>Issues </h4>
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <p><a href="https://github.com/lardemua/atom/issues/323">Add depth component to ATOM's framework -
                    open </a>
                </p>
                <p><a href="https://github.com/lardemua/atom/issues/331">Bug with aruco - closed </a>
                </p>
                <p><a href="https://github.com/lardemua/atom/issues/332">Collector crashes - closed </a>
                </p>

                <p><a href="https://github.com/lardemua/atom/issues/328">Create ids to identify sensors to label instead
                    of identification through message type - closed</a>
                </p>
                <p><a href="https://github.com/lardemua/atom/issues/329">Create metadata field on dataset - closed</a>
                </p>
                <p><a href="https://github.com/lardemua/atom/issues/330">Create conversion script for dataset version 2
                    - open </a>
                </p>
                <p><a href="https://github.com/lardemua/larcc/issues/41">Chessboard support - documentation</a>
                </p>

                <p>(opened but not this week's work)</p>

                <p><a href="https://github.com/lardemua/larcc/issues/35">Change resolution of astra camera to SXGA
                    or
                    XGA - open</a></p>
                <p><a href="https://github.com/lardemua/larcc/issues/37">Reduce camera frame rate in real time -
                    open</a>
                </p>
                <!--                </div>-->
            </div>
        </div>
    </div>
</article>
<!-- Footer-->
<footer class="border-top">
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <ul class="list-inline text-center">
                    <li class="list-inline-item">
                        <a href="#!">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="#!">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
                                    </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="#!">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                        </a>
                    </li>
                </ul>
                <div class="small text-center text-muted fst-italic">Copyright &copy; Your Website 2021</div>
            </div>
        </div>
    </div>
</footer>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="../js/scripts.js"></script>
</body>
</html>
