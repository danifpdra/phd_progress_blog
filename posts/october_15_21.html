<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <title>Daniela's PhD</title>
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico"/>
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"
          type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
          rel="stylesheet" type="text/css"/>
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="../css/styles.css" rel="stylesheet"/>

    <style>
        * {
            box-sizing: border-box;
        }

        .img-zoom-container {
            position: relative;
        }

        .img-zoom-lens {
            position: absolute;
            border: 1px solid #d4d4d4;
            /*set the size of the lens:*/
            width: 80px;
            height: 80px;
        }

        .img-zoom-result {
            border: 1px solid #d4d4d4;
            /*set the size of the result div:*/
            width: 500px;
            height: 500px;
            margin-left: auto;
            margin-right: auto;
        }


    </style>
    <script>
        function imageZoom(imgID, resultID) {
            var img, lens, result, cx, cy;
            img = document.getElementById(imgID);
            result = document.getElementById(resultID);
            /*create lens:*/
            lens = document.createElement("DIV");
            lens.setAttribute("class", "img-zoom-lens");
            /*insert lens:*/
            img.parentElement.insertBefore(lens, img);
            /*calculate the ratio between result DIV and lens:*/
            cx = result.offsetWidth / lens.offsetWidth;
            cy = result.offsetHeight / lens.offsetHeight;
            /*set background properties for the result DIV:*/
            result.style.backgroundImage = "url('" + img.src + "')";
            result.style.backgroundSize = (img.width * cx) + "px " + (img.height * cy) + "px";
            /*execute a function when someone moves the cursor over the image, or the lens:*/
            lens.addEventListener("mousemove", moveLens);
            img.addEventListener("mousemove", moveLens);
            /*and also for touch screens:*/
            lens.addEventListener("touchmove", moveLens);
            img.addEventListener("touchmove", moveLens);

            function moveLens(e) {
                var pos, x, y;
                /*prevent any other actions that may occur when moving over the image:*/
                e.preventDefault();
                /*get the cursor's x and y positions:*/
                pos = getCursorPos(e);
                /*calculate the position of the lens:*/
                x = pos.x - (lens.offsetWidth / 2);
                y = pos.y - (lens.offsetHeight / 2);
                /*prevent the lens from being positioned outside the image:*/
                if (x > img.width - lens.offsetWidth) {
                    x = img.width - lens.offsetWidth;
                }
                if (x < 0) {
                    x = 0;
                }
                if (y > img.height - lens.offsetHeight) {
                    y = img.height - lens.offsetHeight;
                }
                if (y < 0) {
                    y = 0;
                }
                /*set the position of the lens:*/
                lens.style.left = x + "px";
                lens.style.top = y + "px";
                /*display what the lens "sees":*/
                result.style.backgroundPosition = "-" + (x * cx) + "px -" + (y * cy) + "px";
            }

            function getCursorPos(e) {
                var a, x = 0, y = 0;
                e = e || window.event;
                /*get the x and y positions of the image:*/
                a = img.getBoundingClientRect();
                /*calculate the cursor's x and y coordinates, relative to the image:*/
                x = e.pageX - a.left;
                y = e.pageY - a.top;
                /*consider any page scrolling:*/
                x = x - window.pageXOffset;
                y = y - window.pageYOffset;
                return {x: x, y: y};
            }
        }
    </script>
</head>
<body>
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
    <div class="container px-4 px-lg-5">
        <a class="navbar-brand" href="../index.html">Daniela's PhD</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            Menu
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ms-auto py-4 py-lg-0">
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="about.html">About</a></li>
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="post.html">Sample Post</a></li>
                <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="contact.html">Contact</a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- Page Header-->
<header class="masthead" style="background-image: url('../assets/img/larcc_2.jpeg')">
    <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="post-heading">
                    <h1>15 to 21 of October </h1>
                    <h2 class="subheading">Year 2</h2>
                    <span class="meta">
                                Posted by
                                <a href="#!">Daniela Rato</a>
                                on October 21, 2021
                            </span>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- Post Content-->
<article class="mb-4">
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <h2 class="section-heading"> Adding throttle topics option in ATOM and trying different configuration
                    for the collect data function </h2>

                <p>This week's progress:</p>
                <ul>
                    <li>Adaptation of ATOM to have an option to throttle topics. First, I adapted the config file
                        template to receive throttled topics. Then, I added to the configure_calibration_pkg file a for
                        loop to recognized if that sensor has the throttle enabled and at which frame rate. This loop
                        creates a dictionary with the requeried fields and passes it to the playbag.launch template.
                        Here, I used jinja2 to read the dictionary and create new nodes for the throttled topics. It
                        also creates a string with the topics to be remapped and adds them to the node that plays the
                        bag. If bag includes topics with compressed data, it throttles those topics first, by
                        redirecting the throttle to the compressed topics, and then decompresses the already throttled
                        topics.
                    </li>
                    <li>Conceptualization and research about possible options to the framework of ATOM's collect_data
                        function. There are two possible options: turn the subscribers on and off or use
                        wait_for_message to grab instant messages after labelling data. I have also searched about
                        clearing the subscriber queue. Apparently, there is a function in ros cpp that allows to clear
                        it,
                        but not in rospy (?). The option to use the wait_for_message seems more efficient but, to work,
                        the wait_for_message from all the sensors need to be inside the same while loop. In the current
                        ATOM framework, it seems difficult to structure data that way, because it works with classes and
                        a class is instantiated per sensor. I couldn't find any information about whether it is possible
                        or not to turn the subscriber on and off. The question remains if this investigation is still
                        relevant,
                        once the throttler seems to solve the problem that this was also trying to solve.
                    </li>
                    <li>Review of submitted paper (calibration with spherical target)</li>
                </ul>

                <p> TODO </p>
                <ul>
                    <li>Check inconsistencies in calibration results with real data</li>
                    <li>Change ATOM's collector to a more robust solution (?)</li>
                    <li>Adapt ATOM to calibrate RGBD sensors. I think this should be my next line of work while waiting
                        for new computer.
                    </li>
                </ul>

                <!--                <div class="my-4">-->

                <h4>Issues </h4>
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <p><a href="https://github.com/lardemua/larcc/issues/37">Throttle topics to reduce frame rate -
                    closed</a>
                </p>
                <p><a href=https://github.com/lardemua/atom/issues/320>Adding functionality to throttle topics -
                    closed </a>
                </p>
                <p><a href=https://github.com/lardemua/atom/issues/321>Deleting /tmp/dscription.urdf when
                    configuring
                    calibration -
                    closed</a>
                </p>
                <p><a href="https://github.com/lardemua/larcc/issues/36">collect data not working well - open</a>
                </p>
                <p><a href="https://github.com/lardemua/larcc/issues/40">Turn off subscriber in ATOM collect_data
                    when
                    processing data - open</a></p>

                <br style=“line-height:1;”> </br>

                <p>(opened but not this week's work)</p>
                <p><a href="https://github.com/lardemua/larcc/issues/23">calibration in simulation mode - open</a>
                </p>
                <p><a href="https://github.com/lardemua/larcc/issues/32">calibration with real hardware - open</a>
                </p>
                <p><a href="https://github.com/lardemua/larcc/issues/35">Change resolution of astra camera to SXGA
                    or
                    XGA - open</a></p>
                <p><a href="https://github.com/lardemua/larcc/issues/37">reduce camera frame rate in real time -
                    open</a>
                </p>
                <!--                </div>-->
            </div>
        </div>
    </div>
</article>
<!-- Footer-->
<footer class="border-top">
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <ul class="list-inline text-center">
                    <li class="list-inline-item">
                        <a href="#!">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="#!">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
                                    </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="#!">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                        </a>
                    </li>
                </ul>
                <div class="small text-center text-muted fst-italic">Copyright &copy; Your Website 2021</div>
            </div>
        </div>
    </div>
</footer>
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<script src="../js/scripts.js"></script>
</body>
</html>
